{% extends 'base.html' %}

{% block title %}
    {{title}}
{%  endblock %}

{% block body %}
<h1>{{title}}</h1>

{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
        <p style="color: red">{{ message }}</p>
        {% endfor %}
    {% endif %}
{% endwith %}

    <p><button onclick="show_vacancy_form()" id="new_vacancy_button">Add new vacancy</button></p>

    <div id="vacancy_form">
        <form action="/vacancies" method="POST">
            <p>*<input type="text" name="position_name" placeholder="Position name" required></p>
            <p>*<input type="text" name="company" placeholder="Company name" required></p>
            <p>*<textarea name="description" placeholder="Description" required></textarea></p>
            <label for="contacts">Contacts: </label>
              <ul id="contacts">
                <li><input type="text" name="contact_name" placeholder="Contact name"></li>
                <li><input type="email" name="contact_email" placeholder="Contact Email"></li>
                <li><input type="text" name="contact_phone" placeholder="Phone number">
                <li><button onclick="add_new_contact()">Add new field</button></li>
                <li id="new_contact_field">
                    <input type="text" name="new_contact_field" placeholder="Contact type (e.g Phone2)">
                    <input type="text" name="contact_phone" placeholder="Contact value"></li>
              </ul>
            <p><textarea name="comment" placeholder="Your comment"></textarea></p>
            <p><input type="text" name="url" placeholder="Vacancy URL"></p>
            <p><input type="submit" name="add_vacancy" value="Add vacancy" placeholder="Add new vacancy">
                <a href="/vacancies">Cancel</a></p>
        </form>
    </div>
    <div>
        {% for vacancy in vacancies %}
            <ul>
                <li><a href="/vacancy/{{ vacancy['id'] }}"><b>{{vacancy['position_name']}}</b></a></li>
                <i>Created</i>: {{vacancy['creation_date']}}<br>
                <i>Company</i>: {{vacancy['company']}}<br>
            </ul>
        {% endfor %}
    </div>


    <script>
    document.getElementById('vacancy_form').style.display = 'none';
    document.getElementById('new_contact_field').style.display = 'none';


    function show_vacancy_form() {
      document.getElementById('vacancy_form').style.display = 'block';
      document.getElementById('new_vacancy_button').style.display = 'none';
    }

    function add_new_contact() {
        document.getElementById('new_contact_field').style.display = 'block'
    }
    </script>
{% endblock %}
